<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Monitoring - Raspberry Pi</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <span class="logo">üçì</span>
                <h1>Pi Dashboard</h1>
            </div>
            <ul class="nav-menu">
                <li class="nav-item active" data-section="monitoring">
                    <span class="nav-icon">üìä</span>
                    <span>Monitoring</span>
                </li>
                <li class="nav-item" data-section="processes">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Processus</span>
                </li>
                <li class="nav-item" data-section="docker">
                    <span class="nav-icon">üê≥</span>
                    <span>Docker</span>
                </li>
                <li class="nav-item" data-section="files">
                    <span class="nav-icon">üìÅ</span>
                    <span>Fichiers</span>
                </li>
                <li class="nav-item" data-section="system">
                    <span class="nav-icon">üîß</span>
                    <span>Syst√®me</span>
                </li>
            </ul>
            <div class="sidebar-footer">
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Connexion...</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h2 id="sectionTitle">Monitoring</h2>
                </div>
                <div class="header-right">
                    <div class="system-info">
                        <span class="hostname" id="hostname">üñ•Ô∏è chakh98</span>
                        <span class="uptime" id="uptime">‚è±Ô∏è -</span>
                    </div>
                </div>
            </header>

            <!-- Alerts Banner -->
            <div class="alerts-banner" id="alertsBanner" style="display: none;">
                <div class="alerts-content" id="alertsContent"></div>
            </div>

            <!-- Section: Monitoring -->
            <section id="section-monitoring" class="section active">
                <div class="metrics-grid">
                    <!-- CPU Card -->
                    <div class="metric-card">
                        <div class="card-header">
                            <span class="card-icon">‚ö°</span>
                            <h3>CPU</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-display">
                                <span class="metric-value" id="cpuValue">0</span>
                                <span class="metric-unit">%</span>
                            </div>
                            <div class="metric-gauge">
                                <div class="gauge-track">
                                    <div class="gauge-fill" id="cpuGauge"></div>
                                </div>
                            </div>
                        </div>
                        <div class="card-chart">
                            <canvas id="cpuChart"></canvas>
                        </div>
                    </div>

                    <!-- RAM Card -->
                    <div class="metric-card">
                        <div class="card-header">
                            <span class="card-icon">üß†</span>
                            <h3>RAM</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-display">
                                <span class="metric-value" id="ramValue">0</span>
                                <span class="metric-unit">%</span>
                            </div>
                            <div class="metric-details">
                                <span id="ramUsed">0</span> / <span id="ramTotal">0</span> GB
                            </div>
                            <div class="metric-gauge">
                                <div class="gauge-track">
                                    <div class="gauge-fill" id="ramGauge"></div>
                                </div>
                            </div>
                        </div>
                        <div class="card-chart">
                            <canvas id="ramChart"></canvas>
                        </div>
                    </div>

                    <!-- Disk Card -->
                    <div class="metric-card">
                        <div class="card-header">
                            <span class="card-icon">üíæ</span>
                            <h3>Disque</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-display">
                                <span class="metric-value" id="diskValue">0</span>
                                <span class="metric-unit">%</span>
                            </div>
                            <div class="metric-details">
                                <span id="diskUsed">0</span> / <span id="diskTotal">0</span> GB
                            </div>
                            <div class="metric-gauge">
                                <div class="gauge-track">
                                    <div class="gauge-fill" id="diskGauge"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Temperature Card -->
                    <div class="metric-card">
                        <div class="card-header">
                            <span class="card-icon">üå°Ô∏è</span>
                            <h3>Temp√©rature</h3>
                        </div>
                        <div class="card-body">
                            <div class="metric-display">
                                <span class="metric-value" id="tempValue">-</span>
                                <span class="metric-unit">¬∞C</span>
                            </div>
                            <div class="temp-scale">
                                <div class="temp-gradient"></div>
                                <div class="temp-marker" id="tempMarker"></div>
                            </div>
                        </div>
                        <div class="card-chart">
                            <canvas id="tempChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-panel">
                    <h3>üìà Statistiques (1h)</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">CPU Moyen</span>
                            <span class="stat-value" id="statCpuAvg">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">CPU Max</span>
                            <span class="stat-value" id="statCpuMax">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">RAM Moyenne</span>
                            <span class="stat-value" id="statRamAvg">-</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Temp Max</span>
                            <span class="stat-value" id="statTempMax">-</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Processes -->
            <section id="section-processes" class="section">
                <div class="section-header">
                    <h3>Processus en cours</h3>
                    <button class="btn btn-secondary" onclick="loadProcesses()">üîÑ Rafra√Æchir</button>
                </div>
                <div class="table-container">
                    <table class="data-table" id="processesTable">
                        <thead>
                            <tr>
                                <th>PID</th>
                                <th>Nom</th>
                                <th>Utilisateur</th>
                                <th>CPU %</th>
                                <th>RAM %</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="processesBody"></tbody>
                    </table>
                </div>
            </section>

            <!-- Section: Docker -->
            <section id="section-docker" class="section">
                <div class="section-header">
                    <h3>üê≥ Docker</h3>
                    <button class="btn btn-secondary" onclick="loadDockerContainers(); loadDockerImages();">üîÑ
                        Rafra√Æchir</button>
                </div>

                <!-- Applications with accessible ports -->
                <div class="docker-apps-section">
                    <h4 class="subsection-title">üåê Applications</h4>
                    <div class="docker-apps-grid" id="dockerApps">
                        <!-- Apps will be rendered here -->
                    </div>
                </div>

                <!-- Backend services -->
                <div class="docker-services-section">
                    <h4 class="subsection-title">‚öôÔ∏è Services</h4>
                    <div class="table-container">
                        <table class="data-table" id="dockerTable">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Image</th>
                                    <th>√âtat</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="dockerBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Docker Images -->
                <div class="docker-images">
                    <h4 class="subsection-title">üì¶ Images Docker</h4>
                    <div id="dockerImages"></div>
                </div>
            </section>

            <!-- Section: Files -->
            <section id="section-files" class="section">
                <div class="file-manager">
                    <div class="file-header">
                        <div class="file-path">
                            <span class="path-label">üìÇ</span>
                            <input type="text" id="currentPath" value="/" readonly>
                            <button class="btn btn-icon" onclick="navigateUp()">‚¨ÜÔ∏è</button>
                            <button class="btn btn-icon" onclick="loadFiles()">üîÑ</button>
                        </div>
                    </div>
                    <div class="file-content">
                        <div class="file-list" id="fileList"></div>
                        <div class="file-editor" id="fileEditor" style="display: none;">
                            <div class="editor-header">
                                <span id="editorFileName"></span>
                                <div class="editor-actions">
                                    <button class="btn btn-primary" onclick="saveFile()">üíæ Sauvegarder</button>
                                    <button class="btn btn-secondary" onclick="closeEditor()">‚úñÔ∏è Fermer</button>
                                </div>
                            </div>
                            <textarea id="editorContent"></textarea>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: System -->
            <section id="section-system" class="section">
                <div class="system-controls">
                    <h3>‚ö†Ô∏è Contr√¥les Syst√®me</h3>
                    <div class="control-buttons">
                        <button class="btn btn-warning" onclick="confirmAction('reboot')">
                            üîÑ Red√©marrer le Pi
                        </button>
                        <button class="btn btn-danger" onclick="confirmAction('shutdown')">
                            ‚èπÔ∏è Arr√™ter le Pi
                        </button>
                    </div>
                </div>
                <div class="system-services">
                    <h3>üîß Services Syst√®me</h3>
                    <div id="servicesList"></div>
                </div>
            </section>

            <!-- Footer -->
            <footer class="footer">
                <p>Dashboard v2.0 | Derni√®re mise √† jour: <span id="lastUpdate">-</span></p>
            </footer>
        </main>
    </div>

    <!-- Confirm Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 id="modalTitle">Confirmation</h3>
            <p id="modalMessage">√ätes-vous s√ªr ?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">Annuler</button>
                <button class="btn btn-danger" id="modalConfirm">Confirmer</button>
            </div>
        </div>
    </div>

    <script src="/js/dashboard.js"></script>
</body>

</html>